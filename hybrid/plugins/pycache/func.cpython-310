o
    Ã»Ã”hO  Ã£                   @   sÃ€  d dl Z d dlZd dlZd dlZd dlZd dlZd dlZd dl Z d dlm	Z	 d dl
m
Z
 d dlmZm
Z
mZ d dlmZmZ d dlmZmZ d d lmZmZmZ d dlmZmZmZmZmZmZ d d	lm Z  d d
l!m"Z"m#Z#m$Z$m%Z%m&Z&m'Z'm(Z( d
dâ€ Z)dTddâ€Z*defddâ€Z+ddâ€ Z,dUddâ€Z-ddâ€ Z.de/fddâ€Z0dedefddâ€Z1dede2fd d!â€Z3dede4fd"d#â€Z5dVd%e4d&e4fd'd(â€Z6dWd%e4fd)d*â€Z7d+e4d,e2fd-d.â€Z8d d/l9m:Z:m;Z;m<Z< d0Z=dXd+e4d%e4fd1d2â€Z>d3ed+e4d4e/d5e2d6ed7e2fd8d9â€Z?dYd:e2d;ed<e2de@eAe2f fd=d>â€ZBd:e2deAfd?d@â€ZCde2fdAdBâ€ZDdCe2de2fdDdEâ€ZEd4e/de/fdFdGâ€ZFdHe2fdIdJâ€ZGd dKl9mHZHmIZImJZJm:Z: dZdMe2fdNdOâ€ZKd6ed+e4fdPdQâ€ZLd3ed+e4d4e/d6efdRdSâ€ZMdS )[Ã©    N)Ãšexecvp)Ãš
executable)ÃšdatetimeÃš	timedeltaÃštimezone)ÃšClientÃštypes)Ãš	functionsr   )Ãš MessageÃšInlineKeyboardMarkupÃšInlineKeyboardButton)ÃšSessionPasswordNeededÃš	FloodWaitÃšPhoneCodeInvalidÃšPhoneNumberUnoccupiedÃšPhoneNumberBannedÃšRPCError)Ãštemp) Ãš	LANGUAGESÃšD30_RATEÃšD60_RATEÃšD90_RATEÃšAPI_IDÃšAPI_HASHÃšUSDT_ADDRESSc                   C   s   t Â tjÂ¡S Â©N)r   Ãšnowr   ÃšutcÂ© r   r   Ãº4/mnt/c/Users/LENOVO/RentalBot/hybrid/plugins/func.pyÃšget_current_datetime!   s   r    Ã©
   c                  C   sV   |dkrdS t | | d Æ’}t ||  | Æ’}|| }d| d|  }d|â€º d |â€º dÂS )	Nr   zTotal cannot be zero.Ã©d   u   Ã¢â€“Â¥u   Ã¢â€“Â¢Ãº[z] Ãº%)Ãšint) Ãš currentÃštotalÃšlengthÃš
percentageÃš
filled_lengthÃšempty_lengthÃšprogress_barr   r   r   Ãšfetch_progress$   s   r-   Ãšmc                 C   s*   |r
t | |j|jjÆ’ tttddgÆ’ d S )Nz-mÃšhybrid)Ãšrestart_handlerÃšidÃšchatr   r   )Ãšsession_namer.   r   r   r   Ãš restart-   s   r4   c              
   C   s`   | â€º | â€º dÅ“}d}zt j||ddÂ}|jdkrW dS W d S  ty/ } z W Y d }~d S d }~ww )N)ÃšhttpÃšhttpszhttp://httpbin.org/ipr!   )Ãš proxiesÃš timeoutÃ©Ãˆ   TF)ÃšrequestsÃšgetÃš
status_codeÃš	Exception)Ãšpro_xyÃšproxyÃšurlÃšresponseÃšer   r   r   Ãš
check_proxy2   s   Ã¾
â‚¬Ã¿rC   c                 C   sÃº   zt ddÆ’Â
}tÂ |Â¡}W d   Æ’ n1 sw   Y  W n ty'   i }Y n tjy2   i }Y nw |d u s;|d u rE| |v rC||  S d S | |vrMi || < |||  d< |||  d< t ddÆ’Â}tj||dd Â W d   Æ’ ||  S 1 stw   Y  ||  S )NÃºrestart.jsonÃšrÃš
message_idÃš user_idÃšwÃ©   )Ãšindent)ÃšopenÃšjsonÃšloadÃšFileNotFoundErrorÃšJSONDecodeErrorÃšdump)r3   Ãšmsg_idrG   ÃšfÃšrestart_datar   r   r   r0   C   s0   Ã¿â‚¬Ã¿
Ã¿Ã¾r0   c              	   C   sâ€   z4t ddÆ’Â$}tÂ |Â¡}|Â | i Â¡Â dÂ¡}|Â | i Â¡Â dÂ¡}||fW  d   Æ’ W S 1 s-w   Y  W d S  ttjfyA   Y dS w )NrD   rE   rF   rG   Â©NN)rK   rL   rM   r;   rN   rO   )r3   rR   rS   rQ   rG   r   r   r   Ãšget_restart_data[   s   
(Ã¼Ã¿rU   Ãšreturnc              	   C   s$   zt | Æ’W S  ttfy   Y dS w )z9Convert total_hours to float safely (int, float, or str).Ã§        )ÃšfloatÃš	TypeErrorÃš
ValueError)Ãš
total_hoursr   r   r   Ãš_normalize_hourse   s
   
Ã¿r\   Ãšdtc                 C   s2   | du r t Æ’ S | jdu r| jtjdÂS | Â tjÂ¡S )z&Ensure datetime is timezone-aware UTC.NÂ©Ãštzinfo)r    r_   Ãš replacer   r   Ãš
astimezone)r]   r   r   r   Ãš
_ensure_utcl   s
   
rb   Ãš
start_datec           
      C   sÃˆ   t | Æ’} t|Æ’}| t|dÂ }tÆ’ jtjdÂ}|| }|Â  Â¡ dkr#dS |j}t	|j
dÆ’\}} t	| dÆ’\}}	g }
|dkrC|
Â 
|â€º d ÂÂ¡ |dkrO|
Â 
|â€º dÂÂ¡ |dkr[|
Â 
|â€º d	ÂÂ¡ |
rbd
Â |
Â¡S d
S )z(Return remaining time as 'X days Yh Zm'.Â©Ãšhoursr^   r   Ãš ExpiredÃ©  Ã©<   z daysÃšhr.   Ãº Ãš0m)
rb   r\   r   r    r`   r   r   Ãš
total_secondsÃšdaysÃšdivmodÃš secondsÃšappendÃšjoin)
rc   r[   Ãšexpiryr   Ãš	remainingrm   re   Ãš	remainderÃš minutesÃš_Ãšpartsr   r   r   Ãšformat_remaining_timet   s$   rx   c                 C   sR   t | Æ’} t|Æ’}| t|dÂ }tÆ’ }|| }|Â Â¡ dkrdS tdt|Â Â¡ d Æ’Æ’S )z"Return remaining hours as integer.rd   r   rg   ) rb   r\   r   r    rl   Ãšmaxr%   )rc   r[   rr   r   rs   r   r   r   Ãšget_remaining_hoursÅ½   s   rz   Ã©   ÃšpageÃšper_pagec                 C   s>   t tjÆ’}tÂ || Â¡}| d | }|| }tj||â€¦ |fS )Nr{   )Ãšlenr   ÃšNUMBE_RSÃšmathÃšceil)r|   r}   r'   ÃšpagesÃšstartÃšendr   r   r   Ãšget_numbers_pageÅ“   s
   
râ€¦   c               	   Ãƒ   sÃ–   Ât |Æ’\}}g }|D ]}|Â t|d|â€º d|â€º ÂdÂgÂ¡ q
g }|dkr2|Â tdd|d â€º ÂdÂÂ¡ ||k rD|Â td d|d â€º ÂdÂÂ¡ |rK|Â |Â¡ |Â tdd	dÂgÂ¡ | jjd
|â€º d
|â€º dÂt|Æ’d
ÂI d H  d S )NÃš
admin_number_rv   Â©Ãš
callback_datar{   u
   Ã¢Â¬â€¦Ã¯Â¸Â PrevÃšadmin_numbers_page_u
   Ã¢Å¾Â¡Ã¯Â¸Â NextzBack to Admin MenuÃš
admin_panelu!   Ã°Å¸â€œÅ¾ **Available Numbers** (Page Ãº/Ãº)Â©Ãšreply_markup)râ€¦   rp   r   Ãš messageÃš	edit_textr
   ) Ãšqueryr|   Ãš numbersrâ€š   ÃškbÃšnumÃšnavr   r   r   Ãšshow_numbersÂ£   s"   â‚¬"
Ã¾râ€“   rG   Ãškeyc                 K   sH   ddl m} || Æ’p
d}tÂ |td Â¡Â ||Â¡}|r"|jdi |Â¤Å½S |S )Nr   )Ãšget_user_languageÃšenr   )Ãšhybrid.plugins.dbrËœ   r   r;   Ãšformat)rG   râ€”   ÃškwargsrËœ   ÃšlangÃštextr   r   r   ÃštÂ¸   s   rÅ¸   )Ãšget_number_dataÃšget_number_infoÃšsave_number_infoÃ©   c           
   
      sÂ¬  t j}ddâ€ |D Æ’}tÆ’ â€° â€¡ fddâ€|D Æ’}ddâ€ |D Æ’}ddâ€ |D Æ’}|| }|t }|t } ||| â€¦ }g }	|D ]!}
|
t jv rDd}
nd }
|	Â t|
â€º d|
â€º Âd	|
â€º d
|â€º Âd
ÂgÂ¡ q:g }|dkrâ€¹|Â tt | d
Æ’d|d â€º Âd
ÂÂ¡ |Â td|d â€º dtÂ 	t
|Æ’t Â¡â€º Âdd
ÂÂ¡ | t
|Æ’k rÂ¾|dkrÂ­|Â td|d â€º dtÂ 	t
|Æ’t Â¡â€º Âdd
ÂÂ¡ |Â tt | dÆ’d|d â€º Âd
ÂÂ¡ |rÃ…|	Â |Â¡ |	Â tt | dÆ’dd
ÂgÂ¡ t
|	Æ’S )Nc                 S   Ã³   g | ]	}|t jvr|â€˜qS r   )r   Ãš
UN_AV_NUMS)Ãš.0râ€   r   r   r   Ãš
<listcomp>Ã†   Ã³    z*build_rentnum_keyboard.<locals>.<listcomp>c                    s"   g | ]
}|Ë† v sË† Â  |Â¡s|â€˜qS r   )Ãšadd)rÂ¦   ÃšxÂ©Ãšseenr   r   rÂ§   Ãˆ   s   " c                 S   rÂ¤   r   Â©r   Ãš
RENTED_NUMSÂ©rÂ¦   Ãšnr   r   r   rÂ§   ÃŠ   rÂ¨   c                 S   s   g | ]	}|t jv r|â€˜qS r   rÂ­   rÂ¯   r   r   r   rÂ§   Ã‹   rÂ¨   u    Ã°Å¸â€Â´u    Ã°Å¸Å¸Â¢rj   znuminfo:Ãº:râ€¡   r   Ãšbackz
rentnum_page:r{   zPage râ€¹   Ãš
pagenumberÃšnextÃš	back_home)r   Ãš
AVAILABLE_NUMÃšsetÃšNUMBERS_PER_PAGErÂ®   rp   r   rÅ¸   râ‚¬   rÂ   r~   r
   )
rG   r|   Ãšfiltered_numbersÃšavailable_numsÃš
rented_numsÃšordered_numbersrÆ’   râ€   Ãšnumbers_pageÃškeyboardÃšnumberÃšstatusÃš nav_rowr   rÂ«   r   Ãšbuild_rentnum_keyboardÃ„   s<   
 Ã¿"00"
rÃ‚   ÃšclientÃšamountÃš
descriptionÃšmsgÃš payloadc            	   	   Ãƒ   sË†   Â| j |d|ddÂ |Â Â¡ I d H jÂ¡d|dÂ I d H } | j}|jd|â€º d |â€º dÂtt d	| jd
Âgt t	|d
Æ’d|â€º Âd
ÂggÆ’dÂI d H  d S )NÃšUSDTÃš openBotzhttps://t.me/{}i   ) rÃ„   ÃšassetrÃ…   Ãš
paid_btn_nameÃšpaid_btn_urlÃš
expires_inrÃ‡   u#   Ã°Å¸â€™Â¸ **Invoice Created**

Amount: `z` USDT
Description: `z`
Pay using the button below.u   Ã°Å¸â€™Â³ Pay Now)r@   Ãši_paidÃšcheck_payment_râ€¡   rÂ   )
Ãšcreate_invoicerâ€º   Ãšget_meÃšusernameÃš
invoice_idÃšeditr
   r   Ãšbot_invoice_urlrÅ¸   )	ÃšcprÃƒ   rG   rÃ„   rÃ…   rÃ†   rÃ‡   Ãš invoiceÃšinv_idr   r   r   Ãšsend_cp_invoiceÃ°   s,   â‚¬Ã¹	Ã¿Ã¾Ã¾Ã»rÃ™   rÂ¿   ÃšappÃštwo_fa_passwordc           
   
   Ãƒ   sR  Âd| Â  ddÂ¡â€º Â}t|ttdÂ}tÂ dÂ¡ tÂ d| â€º d |â€º dÂÂ¡ d	d
â€ }ÂzÃ¨ÂzÂ³tÂ d
Â¡ |Â Â¡ I dH  tÂ d
| â€º dt |ddÆ’â€º dÂÂ¡ tÂ dÂ¡ z
|Â | Â¡I dH }W nF t	yâ€º }  z:tÂ 
d| j
Â¡ tÂ 
| j
d Â¡I dH  t| ||Æ’I dH W  Y d} ~ W W t |ddÆ’râ€˜|Â Â¡ I dH  tÂ dÂ¡ tÂ dÂ¡ S d} ~ ww tÂ dt |ddÆ’|t |ddÆ’Æ’|t |ddÆ’Æ’t |ddÆ’Â¡ |t |ddÆ’Æ’Â Â¡ }|t |ddÆ’Æ’Â Â¡ }	|dkÂr2|	dkÂr2tÂ d|Â¡ z |j| |jdÂI dH }tÂ d|t |ddÆ’Æ’|t |ddÆ’Æ’Â¡ W nF tÂy1 }  z'tÂ d | Â¡ W Y d} ~ W W t |ddÆ’Âr&|Â Â¡ I dH  tÂ dÂ¡ tÂ dÂ¡ d!S d} ~ ww |dkÂr=tÂ d"Â¡ n tÂ 
d#||	Â¡ d$d%lm}
 d}
td&Æ’D ]@}z|
| Æ’}
W n tÂys }  ztÂ d'| Â¡ d}
W Y d} ~ nd} ~ ww |
ÂrtÂ d(|
Â¡  ntÂ d)|d Â¡ tÂ 
d*Â¡I dH  ÂqP|
ÂsÂ¶tÂ d+| Â¡ W W t |ddÆ’ÂrÂ¯|Â Â¡ I dH  tÂ dÂ¡ tÂ dÂ¡ d,S z|j| |j|
d-ÂI dH  tÂ d.Â¡ W ÂnL tÂyÃ´   tÂ d/Â¡ Y W W t |ddÆ’ÂrÃ­|Â Â¡ I dH  tÂ dÂ¡ tÂ dÂ¡ d0S  tÂy   tÂ d1Â¡ Y W W t |ddÆ’Âr|Â Â¡ I dH  tÂ dÂ¡ tÂ dÂ¡ d2S  tÂys   |Ârlz|Â |Â¡I dH  tÂ d3Â¡ W n: tÂyk }  z(tÂ d4| Â¡ W Y d} ~ Y W W t |ddÆ’Âr`|Â Â¡ I dH  tÂ dÂ¡ tÂ dÂ¡ d5S d} ~ ww tÂ d6Â¡ Y nÂ¤ tÂyÅ“   tÂ d7Â¡ Y W W t |ddÆ’Ârâ€¢|Â Â¡ I dH  tÂ dÂ¡ tÂ dÂ¡ d8S  t	ÂyÃ£ }  z;tÂ 
d9| j
Â¡ tÂ 
| j
d Â¡I dH  t| ||Æ’I dH W  Y d} ~ W W t |ddÆ’ÂrÃ™|Â Â¡ I dH  tÂ dÂ¡ tÂ dÂ¡ S d} ~ w tÂy }  z'tÂ d:| Â¡ W Y d} ~ W W t |ddÆ’Âr
|Â Â¡ I dH  tÂ dÂ¡ tÂ dÂ¡ d;S d} ~ ww z/|Â tj j!d<d=ÂÂ¡I dH  tÂ d>Â¡ W W W t |ddÆ’Âr@|Â Â¡ I dH  tÂ dÂ¡ tÂ dÂ¡ d?S  t"ÂyÂ© }  zVd@t#| Æ’Â Â¡ v Âr~tÂ dAÂ¡ W Y d} ~ W W t |ddÆ’Ârw|Â Â¡ I dH  tÂ dÂ¡ tÂ dÂ¡ dBS tÂ dC| Â¡ W Y d} ~ W W t |ddÆ’ÂrÅ¾|Â Â¡ I dH  tÂ dÂ¡ tÂ dÂ¡ dDS d} ~ w tÂyÃœ }  z'tÂ dE| Â¡ W Y d} ~ W W t |ddÆ’ÂrÃ‘|Â Â¡ I dH  tÂ dÂ¡ tÂ dÂ¡ dDS d} ~ ww  tÂy }  z&tÂ dF| Â¡ W Y d} ~ W t |ddÆ’Âr|Â Â¡ I dH  tÂ dÂ¡ tÂ dÂ¡ dGS d} ~ ww t |ddÆ’Âr#|Â Â¡ I dH  tÂ dÂ¡ tÂ dÂ¡ w )HuW  
    Delete Telegram account linked to `number`.

    Logic:
    - If code type is not FRAGMENT_SMS but next_type is Ã¢â€ â€™ force one resend to switch to Fragment.
    - Wait up to 30s for OTP from Fragment helper.
    - Handle 2FA (immediate deletion if password provided, else scheduled).
    - Manage all known errors, retry on FloodWait.
    z delete-Ãº+Ãš )Ãšapi_idÃšapi_hashz=== delete_account START ===zStarting deletion process for z
 (session='z')c                 S   s   | d u rdS t | dt| Æ’Æ’S )NÃšNoneÃšname)Ãš getattrÃšstr)rÂª   r   r   r   Ãš
_type_name  s   z"delete_account.<locals>._type_namezConnecting pyrogram client...NzConnected to Telegram for z (is_connected=Ãšis_connectedFrÅ’   z1Requesting login code using client.send_code(...)z?FloodWait %s seconds during send_code. Sleeping and retrying...r{   zDisconnected client.z=== delete_account END ===z?SentCode: phone_code_hash=%s, type=%s, next_type=%s, timeout=%sÃšphone_code_hashÃštypeÃš	next_typer8   ÃšFRAGMENT_SMSuL   First code is %s, next_type is FRAGMENT_SMS Ã¢â€ â€™ resending to force Fragment.)rÃ¦   z#After resend: type=%s, next_type=%szResend failed: %s)FÃš
ResendErrorz#Code already sent via Fragment SMS.zFNo Fragment type available (type=%s, next_type=%s). Proceeding anyway.r   )Ãšget_login_codeÃ©   zget_login_code failed: %szReceived OTP: %sz&No OTP yet. Waiting 5s (attempt %d/6).Ã©   zNo OTP received for %s)FÃšOTP)Ãšphone_numberrÃ¦   Ãš
phone_codezSigned in successfully.z"No account exists for this number.)TÃš	NoAccountzInvalid OTP.)FÃš
InvalidOTPz2FA password accepted.z2FA password failed: %s)FÃšInvalid2FAPassworduJ   2FA enabled but no password given Ã¢â€ â€™ deletion will be scheduled (7 days).zNumber banned.)FÃšBannedz(FloodWait %s during sign_in. Retrying...zUnexpected sign_in error: %s)FÃš
SignInErrorÃš Cleanup)ÃšreasonzAccount deleted immediately.)TÃš DeletedÃš2FA_CONFIRM_WAITz)Account scheduled for deletion in 7 days.)TÃš7DayszDeleteAccount RPCError: %s)FÃš
DeleteErrorz"Unexpected DeleteAccount error: %szTop-level error: %s)FÃšError)$r`   r    r   r   Ãš loggingÃšinfoÃš connectrÃ¢   Ãš	send_coder   Ãš warningÃšvalueÃš asyncioÃšsleepÃšdelete_accountÃš
disconnectÃšupperÃš
resend_coderÃ¦   r=   ÃšerrorÃšhybrid.plugins.fragmentrÃ«   ÃšrangeÃš sign_inr   r   r
   Ãšcheck_passwordr   Ãšinvoker	   Ãš accountÃš
DeleteAccountr   rÃ£   )
rÂ¿   rÃš   rÃ›   r3   rÃƒ   rÃ¤   Ãš	sent_coderB   Ãštype_strÃš
next_type_strrÃ«   ÃšotpÃš attemptr   r   r   r    sl  â‚¬


 
 i
â‚¬â€˜

Ã»	Ã½P
â‚¬Â«
â‚¬Ã¾8
ÃˆÃ½
,
Ã’
)
Ã•!
â‚¬Ãš
â‚¬

Ã¢ 
â‚¬Ã¦
â‚¬Ã¦

Ã¯


Ã³	
â‚¬Ãµ
â‚¬Ãµ
â‚¬Ã¹
r  c                 Ãƒ   s   Âddl m} |Â | Â¡I d H S )Nr   )Ãšfragment_api)r
  r  Ãšcheck_is_number_free)rÂ¿   r  r   r   r   Ãšcheck_number_connâ€”  s   â‚¬r  c                 C   sl   t | Æ’} | Â dÂ¡r| }n| Â dÂ¡rd|  }ntdÆ’â€š|ddâ€¦ }|dd â€¦ }|d dâ€¦ }|â€º d|â€º d|â€º ÂS )	zP
    Format a phone number from +88869696069 (int or str) to +888 6969 6069
    z+888Ãš888rÃœ   zNumber must start with +888NrI   rÂ£   rj   )rÃ£   Ãš
startswithrZ   )rÂ¿   Ãšclean_numberÃšprefixÃš
first_blockÃšsecond_blockr   r   r   Ãš
format_numberâ€º  s   


r  Ãšdate_strc              
   C   s^   zt Â | dÂ¡}W n! ty)   zt Â | dÂ¡}W n ty&   t Â | dÂ¡}Y nw Y nw |Â dÂ¡S )Nz%Y-%m-%d %H:%M:%S.%fÃº%Y-%m-%d %H:%M:%Sz%Y-%m-%d %H:%M:%S %Zz%d/%m/%y)r   ÃšstrptimerZ   Ãšstrftime)r   r]   r   r   r   Ãš
format_dateÂ®  s   Ã¿â‚¬Ã½
r$  c                 C   s   t Â ddÂ¡}t| | dÆ’S )Ng{Â®GÃ¡zâ€?g\ÂÃ‚Ãµ(\ÃŸ?Ã©   )ÃšrandomÃš uniformÃšround)rÃ„   Ãšfractionr   r   r   Ãšadd_random_fractionÂ¸  s   r*  Ãš tx_hashc                 C   sÃ¾   d| â€º Â}t Â |Â¡}|Â Â¡  |Â Â¡ }d }d }d}d|v rH|d rH|d d } | Â dÂ¡}t| Â dd Â¡Æ’}t| Â dd	Â¡Æ’}	| Â d
d
Â¡}|d|	  }n2d
|v rzd|d
 v rz|d
 }
|
Â dÂ¡}|
Â dÂ¡}|
Â di Â¡}
t|
Â dd	Â¡Æ’}	|
Â ddÂ¡}|d|	  }|||fS )Nz:https://apilist.tronscanapi.com/api/transaction-info?hash=ÃšTRXÃštrc20TransferInfor   Ãš
to_addressÃš
amount_strÃš0ÃšdecimalsrÃ¬   ÃšsymbolÃšTRC20r!   ÃšcontractDatarÃ„   Ãš	tokenInfoÃštokenDecimalÃš	tokenAbbr)r:   r;   Ãšraise_for_statusrL   r%   )r+  r@   ÃšrespÃšdatar.  Ãšhuman_amountr2  rÅ¸   Ãš
raw_amountr1  ÃšcÃš
token_infor   r   r   Ãš
get_tron_txÂ¼  s.   





r?  )Ãš
number_colÃš
rental_colÃšget_user_balancerÂ    Ãºnumbers_export.csvÃšfilenamec              
   C   sH  t Â i dddÅ“Â¡}g }|D ]g}|d }t|Æ’}|re|Â dÂ¡re|Â dÂ¡}t|Æ’p(d} |Â d Â¡}|Â dÂ¡}	|Â d	dÂ¡}
tÂ Â¡ }
|	|
 }t d|jÆ’}
t d|j	d
 Æ’}|Â 
|d
|| |Â 
dÂ¡|	Â 
dÂ¡|
||
d
Å“	Â¡ q
|Â 
|ddddddddd
Å“	Â¡ q
t| ddddÂÂ}t
j||d Â Â¡ dÂ}|Â Â¡  |Â |Â¡ W d  Æ’ | S 1 sÂw   Y  | S )zÂ¬
    Export all numbers with rental details to a CSV file.

    Columns: Number, Rented, User ID, Balance, Rent Date, Expiry Date, Days Left, Hours Left, Rented Amount
    r   r{   )Ãš_idrÂ¿   rÂ¿   rG   rW   Ãš	rent_dateÃš
expiry_datere   rg   ÃšYesr!  )	ÃšNumberÃšRentedz User IDÃš Balancez	Rent Datez
Expiry Datez	Days Leftz
Hours LeftzRented Amount (Hours)ÃšNorÃ   rH   zutf-8)ÃšmodeÃš newlineÃšencoding)Ãš
fieldnamesN)r@  ÃšfindrÂ    r;   rB  r   Ãšutcnowry   rm   ro   rp   r#  rK   ÃšcsvÃš
DictWriterÃškeysÃš
writeheaderÃš	writerows)rD  Ãš
all_numbersÃšrowsÃš num_docrÂ¿   Ãš
rented_datarG   Ãš balancerF  rG  re   r   rs   Ãš	days_leftÃš
hours_leftÃšfileÃšwriterr   r   r   Ãšexport_numbers_csvÃ   sZ   



Ã·
Ã·

Ã½Ã»ra  c                 Ãƒ   s@   Ât tdddÂgtdddÂggÆ’}|jt|dÆ’|d ÂI d H  d S )Nz@sendÃšset_payment_cryptobotrâ€¡   z
USDT TRC-20Ãšset_payment_tronÃšchoose_payment_methodrÂ   )r
   r   ÃšreplyrÅ¸   )rÃƒ   rÃ†   rG   rÂ¾   r   r   r   Ãšgive_payment_option  s   â‚¬Ã¾Ã¾rf  c                  Ãƒ   sN   Ât }t|Æ’}|jt|d||dÂttt|dÆ’d|â€º ÂdÂggÆ’dÂI d H  d S ) NÃš
pay_amount)rÃ„   Ãš addressrÃ   Ãšcheck_payment_TRON_râ€¡   rÂ   )r   r*  rÃ”   rÅ¸   r
   r   )rÃƒ   rG   rÃ„   rÃ†   Ãštron_addressÃšfinal_amountr   r   r   Ãšsend_tron_invoice#  s   â‚¬Ã¿rl  )r!   rT   )r{   r!   )r{   )r   r   )rC  )NrL   râ‚¬   r  rÃ½   r&  r:   Ãš	tracebackrS  Ãšosr   Ãšsysr   r   r   r   Ãšpyrogramr    r   Ãšpyrogram.rawr	   Ãšpyrogram.typesr
   r
   r   Ãšpyrogram.errorsr
   r   r   r   r   r   Ãšhybrid.plugins.tempr   Ãšconfigr   r   r   r   r   r   r   r    r-   r4   rC   r0   rU   rX   r\   rb   rÃ£   rx   r%   rz   râ€¦   râ€“   rÅ¸   rÅ¡   rÂ    rÂ¡   rÂ¢   rÂ¸   rÃ‚   rÃ™   ÃštupleÃšboolr  r  r  r$  r*  r?  r@  rA  rB  ra  rf  rl  r   r   r   r   Ãš<module>   sZ    	$
	

  ",$ 
 9
